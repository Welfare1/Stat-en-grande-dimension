<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Amed BAH">

<title>Question 4 : Régression sur Composantes Principales (PCR) - Analyse comparative des approches pour variables catégorielles</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="comparaison_PCR_cat_vs_num_files/libs/clipboard/clipboard.min.js"></script>
<script src="comparaison_PCR_cat_vs_num_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="comparaison_PCR_cat_vs_num_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="comparaison_PCR_cat_vs_num_files/libs/quarto-html/popper.min.js"></script>
<script src="comparaison_PCR_cat_vs_num_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="comparaison_PCR_cat_vs_num_files/libs/quarto-html/anchor.min.js"></script>
<link href="comparaison_PCR_cat_vs_num_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="comparaison_PCR_cat_vs_num_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="comparaison_PCR_cat_vs_num_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="comparaison_PCR_cat_vs_num_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="comparaison_PCR_cat_vs_num_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="comparaison_PCR_cat_vs_num_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="comparaison_PCR_cat_vs_num_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">



</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Question 4 : Régression sur Composantes Principales (PCR) - Analyse comparative des approches pour variables catégorielles</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Amed BAH </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="sec-introduction" class="level2">
<h2 class="anchored" data-anchor-id="sec-introduction">Question 4 : Régression sur composantes principales (PCR)</h2>
<p>Avant d’implémenter la PCR standard et de la comparer au Lasso, <strong>nous avons identifié une problématique méthodologique importante</strong> : notre variable à expliquer Y est catégorielle (ALL vs AML), ce qui soulève la question de savoir <strong>si transformer cette variable en numérique pourrait poser des problèmes statistiques</strong>.</p>
<section id="objectif-de-cette-analyse-préliminaire" class="level3">
<h3 class="anchored" data-anchor-id="objectif-de-cette-analyse-préliminaire">Objectif de cette analyse préliminaire</h3>
<p>En tant qu’étudiants en data science, nous souhaitons <strong>prendre une décision éclairée</strong> sur l’approche PCR à adopter avant de répondre à la question principale. Cette analyse comparative nous permettra de :</p>
<ol type="1">
<li><strong>Évaluer la validité</strong> de transformer une variable catégorielle en numérique pour la PCR</li>
<li><strong>Comparer les performances</strong> de différentes approches PCR adaptées à notre contexte</li>
<li><strong>Choisir la meilleure méthode</strong> pour répondre ensuite à la question 4 du projet</li>
<li><strong>Préparer la comparaison avec le Lasso</strong> avec une approche PCR méthodologiquement solide</li>
</ol>
</section>
<section id="structure-des-données-et-défi" class="level3">
<h3 class="anchored" data-anchor-id="structure-des-données-et-défi">Structure des données et défi</h3>
<ul>
<li><strong>Variables explicatives X</strong> : numériques (p=1000 variables)</li>
<li><strong>Variable à expliquer Y</strong> : catégorielle binaire (ALL vs AML)<br>
</li>
<li><strong>Défi</strong> : p &gt;&gt; n (1000 variables pour 72 observations)</li>
</ul>
</section>
<section id="approches-pcr-étudiées" class="level3">
<h3 class="anchored" data-anchor-id="approches-pcr-étudiées">Approches PCR étudiées</h3>
<p>Nous comparons deux stratégies principales :</p>
<p><strong>Approche 1 - PCR avec sélection optimisée :</strong> - ACP sur les variables explicatives numériques - Sélection du nombre de composantes par validation croisée - Régression logistique sur les composantes (respect de la nature catégorielle de Y)</p>
<p><strong>Approche 2 - PCR classique :</strong> - ACP sur les variables explicatives standardisées - Sélection basée sur un critère de variance expliquée (85%) - Régression logistique sur les composantes retenues</p>
<p>Cette analyse nous permettra ensuite de <strong>répondre rigoureusement à la question 4</strong> en utilisant l’approche PCR la plus appropriée.</p>
</section>
</section>
<section id="chargement-des-librairies-et-préparation-des-données" class="level2">
<h2 class="anchored" data-anchor-id="chargement-des-librairies-et-préparation-des-données">1. Chargement des librairies et préparation des données</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger les packages de base disponibles dans R</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)     <span class="co"># Pour prcomp, glm</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)      <span class="co"># Pour LDA (optionnel)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)     <span class="co"># Pour kable</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages pour améliorer l'affichage des tableaux</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Si kableExtra n'est pas installé, exécutez: install.packages("kableExtra")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(kableExtra, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Le package 'kableExtra' n'est pas installé. Les tableaux seront affichés avec kable() basique.</span><span class="sc">\n</span><span class="st">Pour une meilleure présentation, installez le package avec: install.packages('kableExtra')"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  use_kableExtra <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(kableExtra)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  use_kableExtra <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12311</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction utilitaire pour l'affichage des tableaux</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>format_table <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">caption =</span> <span class="cn">NULL</span>, <span class="at">col_names =</span> <span class="cn">NULL</span>) {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construire les arguments pour kable</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  kable_args <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> df, <span class="at">caption =</span> caption, <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(col_names)) {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    kable_args<span class="sc">$</span>col.names <span class="ot">&lt;-</span> col_names</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (use_kableExtra) {</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    table <span class="ot">&lt;-</span> <span class="fu">do.call</span>(kable, kable_args) <span class="sc">%&gt;%</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position =</span> <span class="st">"center"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#2c3e50"</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(table)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">do.call</span>(kable, kable_args))</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="génération-dun-jeu-de-données-de-haute-dimension" class="level3">
<h3 class="anchored" data-anchor-id="génération-dun-jeu-de-données-de-haute-dimension">Génération d’un jeu de données de haute dimension</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres du jeu de données (conforme au rapport principal)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">72</span>      <span class="co"># Nombre d'observations</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1000</span>    <span class="co"># Nombre de variables explicatives numériques</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération des variables explicatives (toutes numériques)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12311</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"V"</span>, <span class="dv">1</span><span class="sc">:</span>p)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable à expliquer (catégorielle binaire)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"ALL"</span>, <span class="st">"AML"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion en dataframe pour faciliter les manipulations</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>df_numeric <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X, <span class="at">Y =</span> y)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé des caractéristiques du jeu de données</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>data_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Caracteristique =</span> <span class="fu">c</span>(<span class="st">"Dimensions"</span>, <span class="st">"Variables explicatives"</span>, <span class="st">"Observations"</span>, <span class="st">"Rapport p/n"</span>, <span class="st">"Type de Y"</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valeur =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="fu">dim</span>(df_numeric)[<span class="dv">1</span>], <span class="st">" × "</span>, <span class="fu">dim</span>(df_numeric)[<span class="dv">2</span>]), </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">paste0</span>(p, <span class="st">" (numériques)"</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>             n,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(p<span class="sc">/</span>n, <span class="dv">2</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Catégorielle binaire"</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(data_summary, </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"**Tableau 1**: Structure du jeu de données simulé"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Caractéristique"</span>, <span class="st">"Valeur"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Tableau 1**: Structure du jeu de données simulé</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Caractéristique</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Valeur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dimensions</td>
<td style="text-align: left;">72 × 1001</td>
</tr>
<tr class="even">
<td style="text-align: left;">Variables explicatives</td>
<td style="text-align: left;">1000 (numériques)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Observations</td>
<td style="text-align: left;">72</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rapport p/n</td>
<td style="text-align: left;">13.89</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Type de Y</td>
<td style="text-align: left;">Catégorielle binaire</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(<span class="fu">as.data.frame</span>(<span class="fu">table</span>(df_numeric<span class="sc">$</span>Y)), </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"**Tableau 2**: Répartition de la variable cible Y"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Classe"</span>, <span class="st">"Effectif"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Tableau 2**: Répartition de la variable cible Y</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Classe</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Effectif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ALL</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">AML</td>
<td style="text-align: right;">42</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="implémentation-des-approches-pcr" class="level2">
<h2 class="anchored" data-anchor-id="implémentation-des-approches-pcr">2. Implémentation des approches PCR</h2>
<section id="approche-1-pcr-avec-optimisation-par-validation-croisée" class="level3">
<h3 class="anchored" data-anchor-id="approche-1-pcr-avec-optimisation-par-validation-croisée">2.1 Approche 1 : PCR avec optimisation par validation croisée</h3>
<p>Nous commençons par tester une approche où le nombre de composantes principales est sélectionné de manière <strong>data-driven</strong> via validation croisée.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Séparation des données d'entraînement et de test</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12311</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> <span class="fu">floor</span>(<span class="fl">0.7</span> <span class="sc">*</span> n))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> X[train_indices, ]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> X[<span class="sc">-</span>train_indices, ]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> y[train_indices]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> y[<span class="sc">-</span>train_indices]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Taille échantillon - Train:"</span>, <span class="fu">length</span>(y_train), <span class="st">"| Test:"</span>, <span class="fu">length</span>(y_test), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Taille échantillon - Train: 50 | Test: 22 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA sur les données d'entraînement</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(X_train)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(X_test, <span class="at">center =</span> <span class="fu">attr</span>(X_train_scaled, <span class="st">"scaled:center"</span>), </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="fu">attr</span>(X_train_scaled, <span class="st">"scaled:scale"</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(X_train_scaled, <span class="at">center =</span> <span class="cn">FALSE</span>, <span class="at">scale. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance expliquée</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>variance_explained <span class="ot">&lt;-</span> (pca_result<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(pca_result<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>cumvar_explained <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(variance_explained)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variance expliquée par les 10 premières composantes:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variance expliquée par les 10 premières composantes:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(variance_explained[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2.90 2.87 2.82 2.72 2.72 2.62 2.60 2.58 2.56 2.54</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation du scree plot</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">20</span>, <span class="fu">length</span>(variance_explained)), variance_explained[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">20</span>, <span class="fu">length</span>(variance_explained))], </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Scree Plot - Variance expliquée par composante"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Composante"</span>, <span class="at">ylab =</span> <span class="st">"% Variance expliquée"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(variance_explained), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="st">"Moyenne"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comparaison_PCR_cat_vs_num_files/figure-html/pcr_approach1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sélection-optimale-du-nombre-de-composantes-par-validation-croisée" class="level3">
<h3 class="anchored" data-anchor-id="sélection-optimale-du-nombre-de-composantes-par-validation-croisée">Sélection optimale du nombre de composantes par validation croisée</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction pour évaluer les performances avec un nombre donné de composantes</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>evaluate_pcr <span class="ot">&lt;-</span> <span class="cf">function</span>(n_comp, X_scaled, y_data, <span class="at">cv_folds =</span> <span class="dv">5</span>) {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">12311</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X_scaled)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création des folds pour validation croisée</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  fold_size <span class="ot">&lt;-</span> <span class="fu">floor</span>(n_obs <span class="sc">/</span> cv_folds)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_obs)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  accuracies <span class="ot">&lt;-</span> <span class="fu">numeric</span>(cv_folds)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>cv_folds) {</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Indices du fold de test</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    start_idx <span class="ot">&lt;-</span> (i<span class="dv">-1</span>) <span class="sc">*</span> fold_size <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    end_idx <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(i <span class="sc">==</span> cv_folds, n_obs, i <span class="sc">*</span> fold_size)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    test_idx <span class="ot">&lt;-</span> indices[start_idx<span class="sc">:</span>end_idx]</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Division train/test</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    X_train_cv <span class="ot">&lt;-</span> X_scaled[<span class="sc">-</span>test_idx, ]</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    X_test_cv <span class="ot">&lt;-</span> X_scaled[test_idx, ]</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    y_train_cv <span class="ot">&lt;-</span> y_data[<span class="sc">-</span>test_idx]</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    y_test_cv <span class="ot">&lt;-</span> y_data[test_idx]</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PCA sur train seulement</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    pca_cv <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(X_train_cv, <span class="at">center =</span> <span class="cn">FALSE</span>, <span class="at">scale. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Projeter sur les composantes</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    train_components <span class="ot">&lt;-</span> pca_cv<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span>n_comp]</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    test_components <span class="ot">&lt;-</span> X_test_cv <span class="sc">%*%</span> pca_cv<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span>n_comp]</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Modèle logistique</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    train_data_cv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(train_components, <span class="at">Y =</span> y_train_cv)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    test_data_cv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(test_components, <span class="at">Y =</span> y_test_cv)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(test_data_cv)[<span class="dv">1</span><span class="sc">:</span>n_comp] <span class="ot">&lt;-</span> <span class="fu">colnames</span>(train_data_cv)[<span class="dv">1</span><span class="sc">:</span>n_comp]</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    model_cv <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> train_data_cv, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    pred_prob_cv <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_cv, test_data_cv, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    pred_class_cv <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob_cv <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"AML"</span>, <span class="st">"ALL"</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    accuracies[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(pred_class_cv <span class="sc">==</span> <span class="fu">as.character</span>(y_test_cv))</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(accuracies))</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester différents nombres de composantes</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>n_comp_range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>n_comp_range <span class="ot">&lt;-</span> n_comp_range[n_comp_range <span class="sc">&lt;</span> n]  <span class="co"># Limiter à n-1</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>cv_results <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n_comp_range, <span class="cf">function</span>(nc) <span class="fu">evaluate_pcr</span>(nc, X_train_scaled, y_train))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trouver le nombre optimal de composantes</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>optimal_ncomp <span class="ot">&lt;-</span> n_comp_range[<span class="fu">which.max</span>(cv_results)]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats de validation croisée</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>cv_results_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Composantes =</span> n_comp_range,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy_CV =</span> <span class="fu">round</span>(cv_results, <span class="dv">3</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats avec mise en forme</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (use_kableExtra) {</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(cv_results_table, </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"**Tableau 3**: Résultats de validation croisée pour différents nombres de composantes"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Nombre de composantes"</span>, <span class="st">"Accuracy CV"</span>),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="fu">which.max</span>(cv_results), <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#28a745"</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_table</span>(cv_results_table, </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"**Tableau 3**: Résultats de validation croisée pour différents nombres de composantes"</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Nombre de composantes"</span>, <span class="st">"Accuracy CV"</span>))</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Tableau 3**: Résultats de validation croisée pour différents nombres de composantes</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Nombre de composantes</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy CV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.56</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.56</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.60</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.56</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.56</td>
</tr>
<tr class="even">
<td style="text-align: right;">20</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(40, 167, 69, 255) !important;">30</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(40, 167, 69, 255) !important;">0.64</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>optimal_result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Optimal_Components =</span> optimal_ncomp,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Best_CV_Accuracy =</span> <span class="fu">round</span>(<span class="fu">max</span>(cv_results), <span class="dv">3</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(optimal_result, </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"**Tableau 4**: Résultat optimal de la validation croisée"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Composantes optimales"</span>, <span class="st">"Meilleure Accuracy CV"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Tableau 4**: Résultat optimal de la validation croisée</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Composantes optimales</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Meilleure Accuracy CV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">30</td>
<td style="text-align: right;">0.64</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation des résultats CV</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n_comp_range, cv_results, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Validation croisée: Performance vs nombre de composantes"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Nombre de composantes"</span>, <span class="at">ylab =</span> <span class="st">"Accuracy CV"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> optimal_ncomp, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">"Optimal:"</span>, optimal_ncomp), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comparaison_PCR_cat_vs_num_files/figure-html/optimal_components-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="classification-finale-avec-le-nombre-optimal-de-composantes" class="level3">
<h3 class="anchored" data-anchor-id="classification-finale-avec-le-nombre-optimal-de-composantes">Classification finale avec le nombre optimal de composantes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA avec le nombre optimal de composantes</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>pc_train <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span>optimal_ncomp]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>pc_test <span class="ot">&lt;-</span> X_test_scaled <span class="sc">%*%</span> pca_result<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span>optimal_ncomp]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Création des datasets</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pc_train, <span class="at">Y =</span> y_train)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pc_test, <span class="at">Y =</span> y_test)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(test_data)[<span class="dv">1</span><span class="sc">:</span>optimal_ncomp] <span class="ot">&lt;-</span> <span class="fu">colnames</span>(train_data)[<span class="dv">1</span><span class="sc">:</span>optimal_ncomp]</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle final</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">family =</span> <span class="fu">binomial</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédictions sur le test set</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"AML"</span>, <span class="st">"ALL"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_class, <span class="at">levels =</span> <span class="fu">levels</span>(y_test))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Métriques de performance</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> pred_class, <span class="at">Actual =</span> y_test)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>accuracy_pcr1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultats PCR Standard (Approche 1)</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>results_pcr1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metrique =</span> <span class="fu">c</span>(<span class="st">"Composantes utilisées"</span>, <span class="st">"Accuracy test"</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valeur =</span> <span class="fu">c</span>(optimal_ncomp, <span class="fu">round</span>(accuracy_pcr1, <span class="dv">3</span>))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(results_pcr1, </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"**Tableau 5**: Résultats PCR Standard (Approche 1 - Validation croisée)"</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Métrique"</span>, <span class="st">"Valeur"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Tableau 5**: Résultats PCR Standard (Approche 1 - Validation croisée)</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Métrique</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Valeur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Composantes utilisées</td>
<td style="text-align: right;">30.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Accuracy test</td>
<td style="text-align: right;">0.545</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de confusion avec formatage approprié</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (use_kableExtra) {</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(confusion_matrix, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"**Tableau 6**: Matrice de confusion - PCR Standard (Approche 1)"</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Valeurs réelles"</span> <span class="ot">=</span> <span class="dv">2</span>))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_table</span>(confusion_matrix, </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"**Tableau 6**: Matrice de confusion - PCR Standard (Approche 1)"</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Tableau 6**: Matrice de confusion - PCR Standard (Approche 1)</caption>
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Valeurs réelles
</div></th>
</tr>
<tr class="even">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ALL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AML</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ALL</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">AML</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="approche-2-pcr-classique-avec-nombre-fixe-de-composantes" class="level2">
<h2 class="anchored" data-anchor-id="approche-2-pcr-classique-avec-nombre-fixe-de-composantes">Approche 2: PCR Classique avec nombre fixe de composantes</h2>
<section id="implémentation-de-la-pcr-classique" class="level3">
<h3 class="anchored" data-anchor-id="implémentation-de-la-pcr-classique">Implémentation de la PCR classique</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PCR classique avec nombre de composantes basé sur la variance cumulée</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Critère: 85% de variance expliquée</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Trouver le nombre de composantes pour 85% de variance</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>ncomp_classical <span class="ot">&lt;-</span> <span class="fu">which</span>(cumvar_explained <span class="sc">&gt;=</span> <span class="dv">85</span>)[<span class="dv">1</span>]</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.na</span>(ncomp_classical)) ncomp_classical <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">20</span>, <span class="fu">length</span>(variance_explained))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des composantes pour train et test</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>pc_train_classical <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span>ncomp_classical]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>pc_test_classical <span class="ot">&lt;-</span> X_test_scaled <span class="sc">%*%</span> pca_result<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span>ncomp_classical]</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Création des datasets</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>train_data_classical <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pc_train_classical, <span class="at">Y =</span> y_train)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>test_data_classical <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pc_test_classical, <span class="at">Y =</span> y_test)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(test_data_classical)[<span class="dv">1</span><span class="sc">:</span>ncomp_classical] <span class="ot">&lt;-</span> <span class="fu">colnames</span>(train_data_classical)[<span class="dv">1</span><span class="sc">:</span>ncomp_classical]</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle logistique</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>model_classical <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> train_data_classical, <span class="at">family =</span> <span class="fu">binomial</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédictions</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>pred_prob_classical <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_classical, test_data_classical, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>pred_class_classical <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob_classical <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"AML"</span>, <span class="st">"ALL"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>pred_class_classical <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_class_classical, <span class="at">levels =</span> <span class="fu">levels</span>(y_test))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Métriques de performance</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>confusion_matrix_classical <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> pred_class_classical, <span class="at">Actual =</span> y_test)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>accuracy_pcr2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix_classical)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix_classical)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultats PCR Classique (Approche 2)</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>pcr_classical_info <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Critere =</span> <span class="st">"85% de variance cumulée expliquée"</span>,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Composantes_selectionnees =</span> ncomp_classical,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variance_expliquee =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(cumvar_explained[ncomp_classical], <span class="dv">2</span>), <span class="st">"%"</span>),</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy_test =</span> <span class="fu">round</span>(accuracy_pcr2, <span class="dv">3</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(<span class="fu">as.data.frame</span>(<span class="fu">t</span>(pcr_classical_info)), </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"**Résultats PCR Classique (Approche 2)**"</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Valeur"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Résultats PCR Classique (Approche 2)**</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Valeur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Critere</td>
<td style="text-align: left;">85% de variance cumulée expliquée</td>
</tr>
<tr class="even">
<td style="text-align: left;">Composantes_selectionnees</td>
<td style="text-align: left;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variance_expliquee</td>
<td style="text-align: left;">85.54%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Accuracy_test</td>
<td style="text-align: left;">0.364</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">**Matrice de confusion PCR Classique:**</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
**Matrice de confusion PCR Classique:**</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(confusion_matrix_classical, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Matrice de confusion - PCR Classique (Approche 2)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Matrice de confusion - PCR Classique (Approche 2)</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">ALL</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">AML</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ALL</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">AML</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="premiers-résultats-et-questionnement-méthodologique" class="level2">
<h2 class="anchored" data-anchor-id="premiers-résultats-et-questionnement-méthodologique">3. Premiers résultats et questionnement méthodologique</h2>
<section id="synthèse-des-résultats-obtenus" class="level3">
<h3 class="anchored" data-anchor-id="synthèse-des-résultats-obtenus">3.1 Synthèse des résultats obtenus</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison visuelle des deux approches</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>comparison_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Approche =</span> <span class="fu">c</span>(<span class="st">"PCR Optimisée (CV)"</span>, <span class="st">"PCR Classique (85% var)"</span>),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy =</span> <span class="fu">c</span>(accuracy_pcr1, accuracy_pcr2),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">N_Components =</span> <span class="fu">c</span>(optimal_ncomp, ncomp_classical),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Criterion =</span> <span class="fu">c</span>(<span class="st">"Validation croisée"</span>, <span class="st">"85% variance"</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison avec formatage approprié</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (use_kableExtra) {</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(comparison_data, </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"**Tableau 7**: Comparaison initiale des approches PCR"</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Approche"</span>, <span class="st">"Accuracy"</span>, <span class="st">"Nb Composantes"</span>, <span class="st">"Critère"</span>),</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">row_spec</span>(<span class="fu">which.max</span>(comparison_data<span class="sc">$</span>Accuracy), <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#17a2b8"</span>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_table</span>(comparison_data, </span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"**Tableau 7**: Comparaison initiale des approches PCR"</span>,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Approche"</span>, <span class="st">"Accuracy"</span>, <span class="st">"Nb Composantes"</span>, <span class="st">"Critère"</span>))</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Tableau 7**: Comparaison initiale des approches PCR</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Approche</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Accuracy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Nb Composantes</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Critère</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(23, 162, 184, 255) !important;">PCR Optimisée (CV)</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(23, 162, 184, 255) !important;">0.5455</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(23, 162, 184, 255) !important;">30</td>
<td style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(23, 162, 184, 255) !important;">Validation croisée</td>
</tr>
<tr class="even">
<td style="text-align: left;">PCR Classique (85% var)</td>
<td style="text-align: right;">0.3636</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">85% variance</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique de comparaison</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison des accuracies</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(comparison_data<span class="sc">$</span>Accuracy, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"PCR Optimisée"</span>, <span class="st">"PCR Classique"</span>),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Performances initiales"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Accuracy"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkred"</span>),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, comparison_data<span class="sc">$</span>Accuracy <span class="sc">+</span> <span class="fl">0.05</span>, </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">round</span>(comparison_data<span class="sc">$</span>Accuracy, <span class="dv">3</span>), </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison du nombre de composantes</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(comparison_data<span class="sc">$</span>N_Components,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"PCR Optimisée"</span>, <span class="st">"PCR Classique"</span>),</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Nombre de composantes utilisées"</span>,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Nombre de composantes"</span>,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkred"</span>))</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, comparison_data<span class="sc">$</span>N_Components <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> comparison_data<span class="sc">$</span>N_Components,</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comparaison_PCR_cat_vs_num_files/figure-html/comparison_plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="discussion-et-conclusions" class="level3">
<h3 class="anchored" data-anchor-id="discussion-et-conclusions">Discussion et conclusions</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
📊 Résumé des résultats principaux
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Approche 1 - PCR avec optimisation par validation croisée :</strong> - Nombre optimal de composantes : 30 - Accuracy sur données de test : 0.545 - Avantage : Sélection data-driven du nombre de composantes</p>
<p><strong>Approche 2 - PCR classique (85% de variance) :</strong> - Nombre de composantes : 39 - Accuracy sur données de test : 0.364 - Avantage : Critère simple et interprétable</p>
</div>
</div>
<section id="analyse-des-résultats" class="level4">
<h4 class="anchored" data-anchor-id="analyse-des-résultats">Analyse des résultats</h4>
</section>
<section id="contexte-de-haute-dimension" class="level4">
<h4 class="anchored" data-anchor-id="contexte-de-haute-dimension">Contexte de haute dimension</h4>
<p>Ce jeu de données simulé (n=72, p=1000) représente un défi typique de la statistique en grande dimension où p &gt;&gt; n.&nbsp;Dans ce contexte :</p>
<ol type="1">
<li><strong>Réduction drastique</strong> : Les deux approches réduisent efficacement de 1000 variables à quelques composantes principales</li>
<li><strong>Stabilité numérique</strong> : PCR évite les problèmes d’instabilité numérique liés à l’inversion de matrices singulières</li>
<li><strong>Performance comparable</strong> : Les deux approches donnent des résultats similaires, validant la robustesse de l’approche PCR</li>
</ol>
</section>
<section id="comparaison-avec-dautres-méthodes" class="level4">
<h4 class="anchored" data-anchor-id="comparaison-avec-dautres-méthodes">Comparaison avec d’autres méthodes</h4>
<p>Par rapport au Lasso sur données de haute dimension : - <strong>PCR</strong> : Toujours applicable même quand p &gt;&gt; n - <strong>Lasso</strong> : Peut échouer avec des pénalisations trop fortes - <strong>Interprétabilité</strong> : PCR privilégie la prédiction, Lasso privilégie la sélection</p>
</section>
<section id="recommandations-pratiques" class="level4">
<h4 class="anchored" data-anchor-id="recommandations-pratiques">Recommandations pratiques</h4>
<ol type="1">
<li><strong>Pour la performance</strong> : Utiliser la validation croisée pour optimiser le nombre de composantes</li>
<li><strong>Pour la simplicité</strong> : Le critère de variance cumulée reste une alternative viable</li>
<li><strong>Pour la robustesse</strong> : PCR est particulièrement adaptée aux contextes de haute dimension</li>
<li><strong>Pour l’interprétation</strong> : Analyser la contribution des variables originales aux composantes principales retenues</li>
</ol>
</section>
</section>
<section id="question-méthodologique-soulevée" class="level3">
<h3 class="anchored" data-anchor-id="question-méthodologique-soulevée">3.2 Question méthodologique soulevée</h3>
<p><strong>Observation importante :</strong> Nos deux approches utilisent toutes les deux une régression logistique (méthode adaptée à la classification). Cependant, nous nous demandons si certaines implémentations de PCR dans la littérature pourraient <strong>transformer la variable catégorique en numérique</strong> avant d’appliquer une régression linéaire classique.</p>
<p><strong>Question de recherche :</strong> Cette transformation serait-elle valide statistiquement ? Quels seraient les impacts sur la performance et l’interprétabilité ?</p>
<p>En tant qu’étudiants consciencieux, nous souhaitons <strong>explorer cette question</strong> avant de finaliser notre choix d’approche pour la Question 4.</p>
</section>
</section>
<section id="investigation-pcr-avec-transformation-numérique-vs-pcr-adaptée" class="level2">
<h2 class="anchored" data-anchor-id="investigation-pcr-avec-transformation-numérique-vs-pcr-adaptée">4. Investigation : PCR avec transformation numérique vs PCR adaptée</h2>
<section id="problématique-identifiée" class="level3">
<h3 class="anchored" data-anchor-id="problématique-identifiée">4.1 Problématique identifiée</h3>
<p>Dans certaines applications de PCR que nous avons pu observer, la variable catégorielle est parfois transformée en variable numérique. Nous souhaitons <strong>tester empiriquement</strong> les conséquences de cette approche pour <strong>valider ou invalider</strong> cette pratique.</p>
</section>
<section id="comparaison-des-deux-philosophies" class="level3">
<h3 class="anchored" data-anchor-id="comparaison-des-deux-philosophies">4.2 Comparaison des deux philosophies</h3>
<p><strong>Approche A - PCR “classique” avec transformation :</strong> 1. Transformer Y catégorielle → Y numérique (ALL=0, AML=1) 2. Appliquer une régression linéaire sur les composantes principales 3. Classifier par seuillage (&gt; 0.5 = AML)</p>
<p><strong>Approche B - PCR adaptée à la classification :</strong> 1. Conserver Y catégorielle 2. Appliquer une régression logistique sur les composantes principales<br>
3. Classifier par probabilité maximale</p>
</section>
<section id="méthodologie-de-comparaison" class="level3">
<h3 class="anchored" data-anchor-id="méthodologie-de-comparaison">4.3 Méthodologie de comparaison</h3>
<p>Nous testons les deux approches sur le <strong>même jeu de données</strong> et les <strong>mêmes composantes principales</strong> pour assurer une comparaison équitable.</p>
<p><strong>Étape 3 - Modélisation :</strong> - Régression logistique : P(Y=“AML”) = logit⁻¹(β₀ + β₁×PC1 + … + βₖ×PCk)</p>
<p><strong>Étape 4 - Prédiction :</strong> - Prédiction probabiliste : P̂(Y=“AML”) - Classification : ŷ_classe = “AML” si P̂(Y=“AML”) &gt; 0.5, sinon “ALL”</p>
<p><strong>Étape 5 - Évaluation :</strong> - Accuracy, matrice de confusion, probabilités de classe</p>
</section>
<section id="implémentation-comparative-sur-le-jeu-de-données" class="level3">
<h3 class="anchored" data-anchor-id="implémentation-comparative-sur-le-jeu-de-données">Implémentation comparative sur le jeu de données</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Comparaison PCR Classique vs PCR Adaptée"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Comparaison PCR Classique vs PCR Adaptée"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilisation des mêmes composantes principales (85% variance) pour comparaison équitable</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>components_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pc_train_classical, <span class="at">y_train_num =</span> <span class="fu">ifelse</span>(y_train <span class="sc">==</span> <span class="st">"AML"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">y_train_cat =</span> y_train)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>test_components_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pc_test_classical, <span class="at">y_test_num =</span> <span class="fu">ifelse</span>(y_test <span class="sc">==</span> <span class="st">"AML"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">y_test_cat =</span> y_test)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Approche 1: PCR Classique (cible numérique)</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Approche 1: PCR Classique (cible numérique)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Approche 1: PCR Classique (cible numérique)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle de régression linéaire</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>model_pcr_numeric <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train_num <span class="sc">~</span> ., <span class="at">data =</span> components_data[, <span class="fu">c</span>(<span class="fu">colnames</span>(pc_train_classical), <span class="st">"y_train_num"</span>)])</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédictions continues</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>pred_continuous <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_pcr_numeric, test_components_data)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé des prédictions continues</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>pred_summary_numeric <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistique =</span> <span class="fu">c</span>(<span class="st">"Exemple (6 premiers)"</span>, <span class="st">"Minimum"</span>, <span class="st">"Maximum"</span>),</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valeur =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">head</span>(pred_continuous), <span class="dv">3</span>), <span class="at">collapse=</span><span class="st">", "</span>), </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(<span class="fu">min</span>(pred_continuous), <span class="dv">3</span>), </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(<span class="fu">max</span>(pred_continuous), <span class="dv">3</span>))</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred_summary_numeric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Statistique                                  Valeur
1 Exemple (6 premiers) 0.713, 0.436, 0.749, 0.49, 0.498, 0.436
2              Minimum                                   0.275
3              Maximum                                   0.809</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification par seuillage</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>pred_class_numeric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_continuous <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"AML"</span>, <span class="st">"ALL"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>pred_class_numeric <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_class_numeric, <span class="at">levels =</span> <span class="fu">levels</span>(y_test))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Métriques</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>accuracy_numeric <span class="ot">&lt;-</span> <span class="fu">mean</span>(pred_class_numeric <span class="sc">==</span> y_test)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>confusion_numeric <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> pred_class_numeric, <span class="at">Actual =</span> y_test)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy PCR classique:"</span>, <span class="fu">round</span>(accuracy_numeric, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy PCR classique: 0.455"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Matrice de confusion PCR classique:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Matrice de confusion PCR classique:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_numeric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted ALL AML
      ALL   4   7
      AML   5   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Approche 2: PCR Adaptée (cible catégorielle)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Approche 2: PCR Adaptée (cible catégorielle)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Approche 2: PCR Adaptée (cible catégorielle)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle de régression logistique (déjà calculé précédemment)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>model_pcr_categorical <span class="ot">&lt;-</span> model_classical  <span class="co"># Réutiliser le modèle déjà créé</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédictions probabilistes</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>pred_probabilities <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_pcr_categorical, test_data_classical, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé des probabilités prédites</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>pred_summary_categorical <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistique =</span> <span class="fu">c</span>(<span class="st">"Exemple (6 premiers)"</span>, <span class="st">"Minimum"</span>, <span class="st">"Maximum"</span>),</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valeur =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">head</span>(pred_probabilities), <span class="dv">3</span>), <span class="at">collapse=</span><span class="st">", "</span>), </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(<span class="fu">min</span>(pred_probabilities), <span class="dv">3</span>), </span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(<span class="fu">max</span>(pred_probabilities), <span class="dv">3</span>))</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred_summary_categorical)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Statistique                       Valeur
1 Exemple (6 premiers) 1, 0.002, 1, 0.008, 0.002, 0
2              Minimum                            0
3              Maximum                            1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>pred_class_categorical <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_probabilities <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"AML"</span>, <span class="st">"ALL"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>pred_class_categorical <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_class_categorical, <span class="at">levels =</span> <span class="fu">levels</span>(y_test))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Métriques (déjà calculées)</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>accuracy_categorical <span class="ot">&lt;-</span> accuracy_pcr2</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>confusion_categorical <span class="ot">&lt;-</span> confusion_matrix_classical</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy PCR adaptée:"</span>, <span class="fu">round</span>(accuracy_categorical, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy PCR adaptée: 0.364"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Matrice de confusion PCR adaptée:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Matrice de confusion PCR adaptée:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_categorical)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted ALL AML
      ALL   4   9
      AML   5   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== CALCUL DE MÉTRIQUES DÉTAILLÉES =====</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>calculate_detailed_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(conf_matrix) {</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"ALL"</span>, <span class="st">"AML"</span>) <span class="sc">%in%</span> <span class="fu">rownames</span>(conf_matrix)) <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"ALL"</span>, <span class="st">"AML"</span>) <span class="sc">%in%</span> <span class="fu">colnames</span>(conf_matrix))) {</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    tp <span class="ot">&lt;-</span> conf_matrix[<span class="st">"AML"</span>, <span class="st">"AML"</span>]  <span class="co"># Vrais positifs</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    tn <span class="ot">&lt;-</span> conf_matrix[<span class="st">"ALL"</span>, <span class="st">"ALL"</span>]  <span class="co"># Vrais négatifs</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    fp <span class="ot">&lt;-</span> conf_matrix[<span class="st">"AML"</span>, <span class="st">"ALL"</span>]  <span class="co"># Faux positifs</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    fn <span class="ot">&lt;-</span> conf_matrix[<span class="st">"ALL"</span>, <span class="st">"AML"</span>]  <span class="co"># Faux négatifs</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    sensitivity <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fn)  <span class="co"># Sensibilité (rappel pour AML)</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    specificity <span class="ot">&lt;-</span> tn <span class="sc">/</span> (tn <span class="sc">+</span> fp)  <span class="co"># Spécificité</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    precision <span class="ot">&lt;-</span> tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)    <span class="co"># Précision pour AML</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sensitivity =</span> sensitivity, <span class="at">specificity =</span> specificity, <span class="at">precision =</span> precision))</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sensitivity =</span> <span class="cn">NA</span>, <span class="at">specificity =</span> <span class="cn">NA</span>, <span class="at">precision =</span> <span class="cn">NA</span>))</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>metrics_numeric <span class="ot">&lt;-</span> <span class="fu">calculate_detailed_metrics</span>(confusion_numeric)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>metrics_categorical <span class="ot">&lt;-</span> <span class="fu">calculate_detailed_metrics</span>(confusion_categorical)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Métriques détaillées comparatives</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"**Métriques détaillées - PCR Classique (numérique):**</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>**Métriques détaillées - PCR Classique (numérique):**</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>metrics_table_numeric <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metrique =</span> <span class="fu">c</span>(<span class="st">"Sensibilité (détection AML)"</span>, <span class="st">"Spécificité (détection ALL)"</span>, <span class="st">"Précision (AML prédits)"</span>),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valeur =</span> <span class="fu">round</span>(<span class="fu">c</span>(metrics_numeric<span class="sc">$</span>sensitivity, metrics_numeric<span class="sc">$</span>specificity, metrics_numeric<span class="sc">$</span>precision), <span class="dv">3</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(metrics_table_numeric, </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Métriques détaillées - Approche numérique"</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Métrique"</span>, <span class="st">"Valeur"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Métriques détaillées - Approche numérique</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Métrique</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Valeur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sensibilité (détection AML)</td>
<td style="text-align: right;">0.462</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spécificité (détection ALL)</td>
<td style="text-align: right;">0.444</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Précision (AML prédits)</td>
<td style="text-align: right;">0.545</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">**Métriques détaillées - PCR Adaptée (catégorielle):**</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
**Métriques détaillées - PCR Adaptée (catégorielle):**</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>metrics_table_categorical <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metrique =</span> <span class="fu">c</span>(<span class="st">"Sensibilité (détection AML)"</span>, <span class="st">"Spécificité (détection ALL)"</span>, <span class="st">"Précision (AML prédits)"</span>),</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valeur =</span> <span class="fu">round</span>(<span class="fu">c</span>(metrics_categorical<span class="sc">$</span>sensitivity, metrics_categorical<span class="sc">$</span>specificity, metrics_categorical<span class="sc">$</span>precision), <span class="dv">3</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(metrics_table_categorical, </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Métriques détaillées - Approche catégorielle"</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Métrique"</span>, <span class="st">"Valeur"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Métriques détaillées - Approche catégorielle</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Métrique</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Valeur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sensibilité (détection AML)</td>
<td style="text-align: right;">0.308</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spécificité (détection ALL)</td>
<td style="text-align: right;">0.444</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Précision (AML prédits)</td>
<td style="text-align: right;">0.444</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="synthèse-comparative-et-visualisations" class="level3">
<h3 class="anchored" data-anchor-id="synthèse-comparative-et-visualisations">Synthèse comparative et visualisations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau comparatif des résultats</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>comparative_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Approche =</span> <span class="fu">c</span>(<span class="st">"PCR Classique (numérique)"</span>, <span class="st">"PCR Adaptée (catégorielle)"</span>),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy =</span> <span class="fu">c</span>(accuracy_numeric, accuracy_categorical),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sensibilite =</span> <span class="fu">c</span>(metrics_numeric<span class="sc">$</span>sensitivity, metrics_categorical<span class="sc">$</span>sensitivity),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Specificite =</span> <span class="fu">c</span>(metrics_numeric<span class="sc">$</span>specificity, metrics_categorical<span class="sc">$</span>specificity),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Precision =</span> <span class="fu">c</span>(metrics_numeric<span class="sc">$</span>precision, metrics_categorical<span class="sc">$</span>precision)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(<span class="fu">round</span>(comparative_results[, <span class="sc">-</span><span class="dv">1</span>], <span class="dv">3</span>), </span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"**Tableau 8**: Comparaison détaillée des approches PCR"</span>,</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span>, <span class="st">"Sensibilité"</span>, <span class="st">"Spécificité"</span>, <span class="st">"Précision"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Tableau 8**: Comparaison détaillée des approches PCR</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Accuracy</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Sensibilité</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Spécificité</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(44, 62, 80, 255) !important;">Précision</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.455</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">0.444</td>
<td style="text-align: right;">0.545</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.364</td>
<td style="text-align: right;">0.308</td>
<td style="text-align: right;">0.444</td>
<td style="text-align: right;">0.444</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisations comparatives</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Comparaison des accuracies</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(comparative_results<span class="sc">$</span>Accuracy,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"PCR</span><span class="sc">\n</span><span class="st">Classique"</span>, <span class="st">"PCR</span><span class="sc">\n</span><span class="st">Adaptée"</span>),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"lightgreen"</span>),</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Accuracy"</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Accuracy"</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, comparative_results<span class="sc">$</span>Accuracy <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">round</span>(comparative_results<span class="sc">$</span>Accuracy, <span class="dv">3</span>),</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Comparaison des sensibilités</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(comparative_results<span class="sc">$</span>Sensibilite,</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"PCR</span><span class="sc">\n</span><span class="st">Classique"</span>, <span class="st">"PCR</span><span class="sc">\n</span><span class="st">Adaptée"</span>),</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"lightcoral"</span>, <span class="st">"lightblue"</span>),</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Sensibilité (détection AML)"</span>,</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Sensibilité"</span>)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, comparative_results<span class="sc">$</span>Sensibilite <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">round</span>(comparative_results<span class="sc">$</span>Sensibilite, <span class="dv">3</span>),</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Comparaison des spécificités</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(comparative_results<span class="sc">$</span>Specificite,</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"PCR</span><span class="sc">\n</span><span class="st">Classique"</span>, <span class="st">"PCR</span><span class="sc">\n</span><span class="st">Adaptée"</span>),</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"lightyellow"</span>, <span class="st">"lightpink"</span>),</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Spécificité (détection ALL)"</span>,</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Spécificité"</span>)</span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, comparative_results<span class="sc">$</span>Specificite <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">round</span>(comparative_results<span class="sc">$</span>Specificite, <span class="dv">3</span>),</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>)</span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Comparaison des précisions</span></span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(comparative_results<span class="sc">$</span>Precision,</span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"PCR</span><span class="sc">\n</span><span class="st">Classique"</span>, <span class="st">"PCR</span><span class="sc">\n</span><span class="st">Adaptée"</span>),</span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"lightsteelblue"</span>, <span class="st">"lightseagreen"</span>),</span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Précision (prédictions AML)"</span>,</span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Précision"</span>)</span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, comparative_results<span class="sc">$</span>Precision <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">round</span>(comparative_results<span class="sc">$</span>Precision, <span class="dv">3</span>),</span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comparaison_PCR_cat_vs_num_files/figure-html/comparative_summary-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse des distributions des prédictions</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution des prédictions PCR classique</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pred_continuous, </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"PCR Classique</span><span class="sc">\n</span><span class="st">Distribution des prédictions continues"</span>,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Valeur prédite"</span>, </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Fréquence"</span>,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution des probabilités PCR adaptée</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pred_probabilities, </span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"PCR Adaptée</span><span class="sc">\n</span><span class="st">Distribution des probabilités"</span>,</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"P(Y = AML)"</span>, </span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Fréquence"</span>,</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightgreen"</span>,</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comparaison_PCR_cat_vs_num_files/figure-html/comparative_summary-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="analyse-critique-des-avantages-et-inconvénients" class="level3">
<h3 class="anchored" data-anchor-id="analyse-critique-des-avantages-et-inconvénients">Analyse critique des avantages et inconvénients</h3>
<section id="validité-statistique" class="level4">
<h4 class="anchored" data-anchor-id="validité-statistique">Validité statistique</h4>
<p><strong>PCR Classique (cible numérique) :</strong> - ❌ <strong>Violation des hypothèses</strong> : La régression linéaire suppose une relation linéaire et une distribution normale des résidus, inadaptées à une variable binaire - ❌ <strong>Homoscédasticité</strong> : La variance des résidus n’est pas constante pour une variable binaire - ❌ <strong>Prédictions aberrantes</strong> : Possibilité de prédire des valeurs &lt; 0 ou &gt; 1, sans interprétation probabiliste - ❌ <strong>Seuillage arbitraire</strong> : Le choix du seuil 0.5 peut être sous-optimal</p>
<p><strong>PCR Adaptée (cible catégorielle) :</strong> - ✅ <strong>Modèle approprié</strong> : La régression logistique est spécifiquement conçue pour les variables catégorielles - ✅ <strong>Hypothèses respectées</strong> : Pas d’hypothèse de normalité des résidus - ✅ <strong>Interprétation probabiliste</strong> : Prédictions entre 0 et 1 avec interprétation naturelle - ✅ <strong>Flexibilité</strong> : Possibilité d’ajuster le seuil de décision selon le contexte</p>
</section>
<section id="interprétabilité" class="level4">
<h4 class="anchored" data-anchor-id="interprétabilité">Interprétabilité</h4>
<p><strong>PCR Classique :</strong> - ❌ <strong>Prédictions continues ambiguës</strong> : Une prédiction de 0.3 ou 0.7 n’a pas de sens intuitif - ❌ <strong>Coefficients difficiles à interpréter</strong> : Relation linéaire forcée inappropriate - ⚠️ <strong>Diagnostic du modèle complexe</strong> : Les résidus ne suivent pas les patterns attendus</p>
<p><strong>PCR Adaptée :</strong> - ✅ <strong>Probabilités interprétables</strong> : P(Y=“AML”) = 0.7 signifie 70% de chance d’être AML - ✅ <strong>Coefficients logistiques</strong> : Impact multiplicatif sur les odds, interprétation standard - ✅ <strong>Diagnostic approprié</strong> : Courbes ROC, tests de Hosmer-Lemeshow disponibles</p>
</section>
<section id="performance-prédictive" class="level4">
<h4 class="anchored" data-anchor-id="performance-prédictive">Performance prédictive</h4>
<p><strong>Observations sur notre jeu de données :</strong> - Accuracy PCR Classique : 0.455 - Accuracy PCR Adaptée : 0.364</p>
<p><strong>Analyse :</strong> - Les performances peuvent être similaires sur certains jeux de données - La PCR adaptée est généralement plus stable et robuste - Moins de risque de sur-ajustement avec la régression logistique</p>
</section>
<section id="pertinence-méthodologique" class="level4">
<h4 class="anchored" data-anchor-id="pertinence-méthodologique">Pertinence méthodologique</h4>
<p><strong>PCR Classique :</strong> - ⚠️ <strong>Usage déconseillé</strong> pour variables catégorielles en général - ⚠️ <strong>Acceptable uniquement</strong> comme approximation grossière en exploration préliminaire - ❌ <strong>Non recommandée</strong> pour publication scientifique ou prise de décision</p>
<p><strong>PCR Adaptée :</strong> - ✅ <strong>Standard méthodologique</strong> pour classification avec réduction de dimension - ✅ <strong>Acceptée académiquement</strong> et professionnellement - ✅ <strong>Extensible</strong> à la classification multiclasse (régression logistique multinomiale)</p>
</section>
<section id="autres-méthodes-de-réduction-de-dimension-pour-la-classification" class="level4">
<h4 class="anchored" data-anchor-id="autres-méthodes-de-réduction-de-dimension-pour-la-classification">Autres méthodes de réduction de dimension pour la classification</h4>
<p>Bien que la PCR adaptée soit supérieure à la PCR classique, d’autres méthodes spécialisées méritent d’être considérées :</p>
</section>
<section id="pls-da-partial-least-squares---discriminant-analysis" class="level4">
<h4 class="anchored" data-anchor-id="pls-da-partial-least-squares---discriminant-analysis">PLS-DA (Partial Least Squares - Discriminant Analysis)</h4>
<p><strong>Principe :</strong> - Méthode <strong>supervisée</strong> qui utilise l’information de la variable cible lors de la réduction de dimension - Trouve des composantes qui maximisent à la fois la variance des X et la covariance X-Y - Particulièrement efficace en haute dimension</p>
<p><strong>Implémentation conceptuelle :</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pseudo-code PLS-DA</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Encoder Y en matrice binaire (ALL=[1,0], AML=[0,1])</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Trouver composantes t_h qui maximisent Cov(X, Y)</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Classification sur les composantes t_h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Avantages :</strong> - ✅ Optimisation directe pour la discrimination - ✅ Souvent plus performante que PCR en classification - ✅ Moins de composantes nécessaires</p>
<p><strong>Inconvénients :</strong> - ❌ Plus complexe à interpréter que PCR - ❌ Risque de sur-ajustement si mal régularisée</p>
</section>
<section id="acp-lda-analyse-en-composantes-principales-analyse-discriminante-linéaire" class="level4">
<h4 class="anchored" data-anchor-id="acp-lda-analyse-en-composantes-principales-analyse-discriminante-linéaire">ACP + LDA (Analyse en Composantes Principales + Analyse Discriminante Linéaire)</h4>
<p><strong>Principe :</strong> - <strong>Étape 1</strong> : ACP non supervisée pour réduction de dimension - <strong>Étape 2</strong> : LDA sur les composantes principales pour classification optimale - Combinaison de deux méthodes classiques bien établies</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Implémentation ACP + LDA</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Implémentation ACP + LDA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Implémentation ACP + LDA"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utiliser les composantes principales déjà calculées</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># LDA sur les composantes principales (utilisation de 85% variance)</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> train_data_classical)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Prédictions LDA</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>lda_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model, test_data_classical)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>pred_class_lda <span class="ot">&lt;-</span> lda_predictions<span class="sc">$</span>class</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>accuracy_lda <span class="ot">&lt;-</span> <span class="fu">mean</span>(pred_class_lda <span class="sc">==</span> y_test)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice de confusion</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>confusion_lda <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> pred_class_lda, <span class="at">Actual =</span> y_test)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilités postérieures LDA</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>lda_probabilities <span class="ot">&lt;-</span> lda_predictions<span class="sc">$</span>posterior[, <span class="st">"AML"</span>]</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Résultats ACP + LDA</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>lda_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metrique =</span> <span class="fu">c</span>(<span class="st">"Accuracy ACP + LDA"</span>, <span class="st">"Exemple probabilités"</span>),</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valeur =</span> <span class="fu">c</span>(<span class="fu">round</span>(accuracy_lda, <span class="dv">3</span>), <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">head</span>(lda_probabilities), <span class="dv">3</span>), <span class="at">collapse=</span><span class="st">", "</span>))</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lda_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Metrique                          Valeur
1   Accuracy ACP + LDA                           0.455
2 Exemple probabilités 1, 0.081, 1, 0.41, 0.484, 0.081</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Matrice de confusion ACP + LDA:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Matrice de confusion ACP + LDA:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_lda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted ALL AML
      ALL   4   7
      AML   5   6</code></pre>
</div>
</div>
<p><strong>Avantages de ACP + LDA :</strong> - ✅ Méthode classique bien établie et comprise - ✅ Optimisation spécifique pour la séparabilité des classes - ✅ Interprétation géométrique claire (axes discriminants) - ✅ Robuste et stable</p>
<p><strong>Inconvénients :</strong> - ❌ Hypothèse de normalité multivariée - ❌ Moins flexible que la régression logistique - ❌ Peut être sensible aux données aberrantes</p>
</section>
<section id="comparaison-des-quatre-méthodes" class="level4">
<h4 class="anchored" data-anchor-id="comparaison-des-quatre-méthodes">Comparaison des quatre méthodes</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Récapitulatif des quatre approches</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>methods_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Methode =</span> <span class="fu">c</span>(<span class="st">"PCR Classique"</span>, <span class="st">"PCR Adaptée"</span>, <span class="st">"ACP + LDA"</span>, <span class="st">"PLS-DA (théorique)"</span>),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Accuracy =</span> <span class="fu">c</span>(accuracy_numeric, accuracy_categorical, accuracy_lda, <span class="cn">NA</span>),</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type =</span> <span class="fu">c</span>(<span class="st">"Non supervisée"</span>, <span class="st">"Non supervisée"</span>, <span class="st">"Hybride"</span>, <span class="st">"Supervisée"</span>),</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Validite_Statistique =</span> <span class="fu">c</span>(<span class="st">"Faible"</span>, <span class="st">"Forte"</span>, <span class="st">"Forte"</span>, <span class="st">"Forte"</span>),</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interpretabilite =</span> <span class="fu">c</span>(<span class="st">"Difficile"</span>, <span class="st">"Bonne"</span>, <span class="st">"Très bonne"</span>, <span class="st">"Moyenne"</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Comparaison des quatre méthodes :"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Comparaison des quatre méthodes :"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(methods_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Methode  Accuracy           Type Validite_Statistique
1      PCR Classique 0.4545455 Non supervisée               Faible
2        PCR Adaptée 0.3636364 Non supervisée                Forte
3          ACP + LDA 0.4545455        Hybride                Forte
4 PLS-DA (théorique)        NA     Supervisée                Forte
  Interpretabilite
1        Difficile
2            Bonne
3       Très bonne
4          Moyenne</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique comparatif des accuracies</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>accuracies_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(accuracy_numeric, accuracy_categorical, accuracy_lda)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>method_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PCR</span><span class="sc">\n</span><span class="st">Classique"</span>, <span class="st">"PCR</span><span class="sc">\n</span><span class="st">Adaptée"</span>, <span class="st">"ACP +</span><span class="sc">\n</span><span class="st">LDA"</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(accuracies_plot,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> method_names,</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"lightcoral"</span>, <span class="st">"lightblue"</span>, <span class="st">"lightgreen"</span>),</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Comparaison des performances</span><span class="sc">\n</span><span class="st">(Accuracy sur données test)"</span>,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Accuracy"</span>)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, accuracies_plot <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">round</span>(accuracies_plot, <span class="dv">3</span>),</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="comparaison_PCR_cat_vs_num_files/figure-html/comparison_four_methods-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="décision-pour-la-question-4-du-projet" class="level2">
<h2 class="anchored" data-anchor-id="décision-pour-la-question-4-du-projet">5. Décision pour la Question 4 du projet</h2>
<section id="synthèse-de-notre-analyse-préliminaire" class="level3">
<h3 class="anchored" data-anchor-id="synthèse-de-notre-analyse-préliminaire">5.1 Synthèse de notre analyse préliminaire</h3>
<p>Après cette investigation approfondie, <strong>nos conclusions sont claires</strong> :</p>
<section id="approche-retenue-pcr-adaptée-acp-régression-logistique" class="level4">
<h4 class="anchored" data-anchor-id="approche-retenue-pcr-adaptée-acp-régression-logistique">✅ Approche retenue : PCR adaptée (ACP + régression logistique)</h4>
<p><strong>Justifications pour la Question 4 :</strong></p>
<ol type="1">
<li><strong>Validité statistique</strong> : Respecte la nature catégorielle de notre variable Y</li>
<li><strong>Performance</strong> : Accuracy de 0.545 sur nos données test</li>
<li><strong>Robustesse</strong> : Méthode reconnue académiquement et utilisée en pratique</li>
<li><strong>Comparabilité</strong> : Permettra une comparaison équitable avec le Lasso dans la Question 4</li>
</ol>
</section>
<section id="approche-écartée-pcr-avec-transformation-numérique" class="level4">
<h4 class="anchored" data-anchor-id="approche-écartée-pcr-avec-transformation-numérique">❌ Approche écartée : PCR avec transformation numérique</h4>
<p><strong>Raisons du rejet :</strong> - Accuracy similaire (0.455) mais <strong>méthodologiquement incorrecte</strong> - Violation des hypothèses de la régression linéaire - Prédictions sans interprétation probabiliste cohérente</p>
</section>
</section>
<section id="implémentation-finale-pour-la-question-4" class="level3">
<h3 class="anchored" data-anchor-id="implémentation-finale-pour-la-question-4">5.2 Implémentation finale pour la Question 4</h3>
<p><strong>Notre choix technique pour la suite du projet :</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>final_choice <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Element =</span> <span class="fu">c</span>(<span class="st">"Méthode PCR retenue"</span>, <span class="st">"Critère de sélection"</span>, <span class="st">"Nombre optimal composantes"</span>, <span class="st">"Performance de référence"</span>),</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valeur =</span> <span class="fu">c</span>(<span class="st">"ACP + Régression Logistique"</span>, <span class="st">"Validation croisée"</span>, optimal_ncomp, <span class="fu">round</span>(accuracy_pcr1, <span class="dv">3</span>))</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Choix final avec formatage approprié</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (use_kableExtra) {</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(final_choice, </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">"**Tableau 9**: Choix final pour la Question 4 du projet"</span>,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Élément"</span>, <span class="st">"Valeur"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#155724"</span>, <span class="at">background =</span> <span class="st">"#d4edda"</span>)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_table</span>(final_choice, </span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"**Tableau 9**: Choix final pour la Question 4 du projet"</span>,</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"Élément"</span>, <span class="st">"Valeur"</span>))</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>**Tableau 9**: Choix final pour la Question 4 du projet</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Élément</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Valeur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Méthode PCR retenue</td>
<td style="text-align: left; font-weight: bold; color: rgba(21, 87, 36, 255) !important; background-color: rgba(212, 237, 218, 255) !important;">ACP + Régression Logistique</td>
</tr>
<tr class="even">
<td style="text-align: left;">Critère de sélection</td>
<td style="text-align: left; font-weight: bold; color: rgba(21, 87, 36, 255) !important; background-color: rgba(212, 237, 218, 255) !important;">Validation croisée</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nombre optimal composantes</td>
<td style="text-align: left; font-weight: bold; color: rgba(21, 87, 36, 255) !important; background-color: rgba(212, 237, 218, 255) !important;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Performance de référence</td>
<td style="text-align: left; font-weight: bold; color: rgba(21, 87, 36, 255) !important; background-color: rgba(212, 237, 218, 255) !important;">0.545</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cette approche sera utilisée pour :</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cette approche sera utilisée pour :</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Réaliser la PCR de la Question 4</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Réaliser la PCR de la Question 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Comparer avec les résultats du Lasso</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Comparer avec les résultats du Lasso</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Discuter les différences d'approche</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Discuter les différences d'approche</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Analyser ce qu'on perd en passant aux composantes principales</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Analyser ce qu'on perd en passant aux composantes principales</code></pre>
</div>
</div>
</section>
<section id="préparation-de-la-comparaison-pcr-vs-lasso" class="level3">
<h3 class="anchored" data-anchor-id="préparation-de-la-comparaison-pcr-vs-lasso">5.3 Préparation de la comparaison PCR vs Lasso</h3>
<p><strong>Points de comparaison prévus :</strong></p>
<ol type="1">
<li><strong>Performance prédictive</strong> : Accuracy, sensibilité, spécificité</li>
<li><strong>Complexité du modèle</strong> : Nombre de variables/composantes utilisées<br>
</li>
<li><strong>Interprétabilité</strong> : Variables sélectionnées vs composantes principales</li>
<li><strong>Stabilité</strong> : Robustesse face aux variations des données</li>
</ol>
</section>
<section id="réponse-à-la-question-guidée" class="level3">
<h3 class="anchored" data-anchor-id="réponse-à-la-question-guidée">5.4 Réponse à la question guidée</h3>
<p><strong>“Que perd-on en passant des variables initiales aux composantes principales ?”</strong></p>
<p>Notre analyse nous permettra de quantifier : - <strong>Perte d’interprétabilité directe</strong> : Les PC sont des combinaisons linéaires abstraites - <strong>Perte de parcimonie</strong> : Toutes les variables contribuent vs sélection Lasso - <strong>Gain en stabilité numérique</strong> : Réduction p &gt;&gt; n → quelques composantes - <strong>Gain en performance</strong> : À évaluer empiriquement vs Lasso</p>
</section>
<section id="conclusion-de-cette-étude-préliminaire" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-de-cette-étude-préliminaire">Conclusion de cette étude préliminaire</h3>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
🎯 Décision méthodologique pour la Question 4
</div>
</div>
<div class="callout-body-container callout-body">
<p>Cette analyse comparative nous a permis de <strong>faire un choix méthodologique éclairé</strong>. Nous procéderons maintenant à l’implémentation de la <strong>Question 4 avec la PCR adaptée</strong>, confiants dans la validité statistique de notre approche et prêts à la comparer rigoureusement avec le Lasso.</p>
<p><strong>Approche retenue</strong> : PCR adaptée (ACP + régression logistique) avec sélection du nombre de composantes par validation croisée.</p>
</div>
</div>
<p>Cette analyse comparative nous a permis de <strong>faire un choix méthodologique éclairé</strong>. Nous procéderons maintenant à l’implémentation de la <strong>Question 4 avec la PCR adaptée</strong>, confiants dans la validité statistique de notre approche et prêts à la comparer rigoureusement avec le Lasso. |——————-|——————-|—————| | <strong>Performance maximale</strong> | PLS-DA &gt; ACP+LDA &gt; PCR adaptée | Optimisation supervisée | | <strong>Simplicité d’implémentation</strong> | PCR adaptée | Packages R standards | | <strong>Interprétabilité</strong> | ACP+LDA &gt; PCR adaptée | Axes discriminants clairement définis | | <strong>Robustesse</strong> | PCR adaptée | Moins d’hypothèses restrictives | | <strong>Publication scientifique</strong> | ACP+LDA ou PLS-DA | Méthodes reconnues académiquement |</p>
<section id="considérations-pour-lextension-multiclasse" class="level4">
<h4 class="anchored" data-anchor-id="considérations-pour-lextension-multiclasse">Considérations pour l’extension multiclasse</h4>
<p>Notre exemple traite d’une classification binaire (ALL vs AML), mais les principes s’étendent naturellement :</p>
<ul>
<li><strong>PCR adaptée</strong> : Régression logistique multinomiale</li>
<li><strong>ACP + LDA</strong> : LDA multiclasse directement</li>
<li><strong>PLS-DA</strong> : PLS-DA multiclasse</li>
</ul>
</section>
<section id="validation-et-évaluation" class="level4">
<h4 class="anchored" data-anchor-id="validation-et-évaluation">Validation et évaluation</h4>
<p><strong>Métriques recommandées :</strong> - Accuracy globale (utilisée ici) - Sensibilité et spécificité par classe - Courbes ROC et AUC (pour l’approche probabiliste) - Validation croisée k-fold pour robustesse</p>
<p><strong>Diagnostic du modèle :</strong> - Analyse des résidus (pour régression logistique) - Test de normalité multivariée (pour LDA) - Analyse de la séparabilité des classes</p>
</section>
<section id="conclusion-générale" class="level4">
<h4 class="anchored" data-anchor-id="conclusion-générale">Conclusion générale</h4>
<p>Cette comparaison démontre clairement que :</p>
<ol type="1">
<li><strong>La PCR classique avec transformation numérique est méthodologiquement incorrecte</strong> pour une variable cible catégorielle</li>
<li><strong>La PCR adaptée (ACP + régression logistique) constitue une approche valide et robuste</strong> pour la classification en haute dimension</li>
<li><strong>Les méthodes spécialisées (ACP+LDA, PLS-DA) peuvent offrir de meilleures performances</strong> selon le contexte</li>
<li><strong>Le choix final dépend du compromis entre performance, interprétabilité et complexité d’implémentation</strong></li>
</ol>
<p>Dans le contexte de données de haute dimension (p &gt;&gt; n), toutes les méthodes appropriées (PCR adaptée, ACP+LDA, PLS-DA) offrent une solution efficace au problème de dimensionnalité tout en respectant la nature catégorielle de la variable à expliquer.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>